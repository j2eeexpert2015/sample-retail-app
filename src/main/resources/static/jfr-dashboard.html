<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JFR Recording Control</title>
    <link rel="stylesheet" href="css/jfr-dashboard.css">
</head>
<body>
<div class="container">
    <div class="header">
        <h1>ğŸ¬ JFR Recording Control</h1>
        <p>Manage JFR Recordings and analyze Virtual Thread performance</p>
    </div>

    <div class="content">
        <div class="instructions">
            <h3>ğŸš€ Quick Start</h3>
            <ol>
                <li>Start a recording before running your virtual thread tests</li>
                <li>Execute your application workload via <a href="vt-test.html">VT Test Runner</a></li>
                <li>Stop the recording to save data to disk</li>
                <li>Click "Analyze Last Recording" to get analysis in server logs</li>
                <li>Optional: Analyze .jfr files with JDK Mission Control for deeper analysis</li>
            </ol>
        </div>

        <div class="test-section">
            <h3>ğŸ“¹ Recording Control</h3>
            <p>Manage JFR recordings for detailed virtual thread analysis</p>
            <div class="btn-grid">
                <button class="btn btn-success" onclick="handleJFRAction('/jfr/start', this)">
                    â–¶ï¸ Start Recording<br>
                    <small>Begin JFR capture</small>
                </button>
                <button class="btn btn-danger" onclick="handleJFRAction('/jfr/stop', this)">
                    â¹ï¸ Stop Recording<br>
                    <small>Save to disk</small>
                </button>
                <button class="btn btn-secondary" onclick="handleJFRAction('/jfr/start?name=CustomTest', this)">
                    ğŸ·ï¸ Custom Recording<br>
                    <small>Start with name</small>
                </button>
                <button class="btn btn-success" onclick="analyzeLastRecording()" id="analyze-btn">
                    ğŸ” Analyze Last Recording<br>
                    <small>Check server logs</small>
                </button>
            </div>
        </div>

        <div class="test-section monitoring-section">
            <h3>ğŸ“Š Monitoring & Analysis</h3>
            <div class="monitoring-grid">
                <a href="http://localhost:3000/d/virtual-thread-metrics" target="_blank" rel="noopener" class="monitor-link">
                    ğŸ“ˆ Grafana Dashboard
                </a>
                <a href="vt-test.html" class="monitor-link">
                    ğŸ§µ VT Test Runner
                </a>
                <a href="/actuator/prometheus" target="_blank" rel="noopener" class="monitor-link">
                    ğŸ“Š Raw Metrics
                </a>
            </div>
        </div>

        <div class="results">
            <h3>ğŸ“‹ Recording Status</h3>
            <div id="status-log">Checking JFR status...\n</div>
            <button class="clear-btn" onclick="refreshStatus()">Refresh Status</button>
        </div>
    </div>
</div>

<script src="js/jfr-dashboard.js"></script>
</body>
</html>